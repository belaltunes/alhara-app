/**
 * Seed Script for Alhara App
 * Usage: npx ts-node scripts/seed.ts
 *
 * Requires EXPO_PUBLIC_SUPABASE_URL and EXPO_PUBLIC_SUPABASE_ANON_KEY
 * (or use service_role key for bypassing RLS)
 *
 * Set SUPABASE_SERVICE_ROLE_KEY in your environment for full access.
 */

import { createClient } from "@supabase/supabase-js";
import * as dotenv from "dotenv";

dotenv.config();

const supabaseUrl = process.env.EXPO_PUBLIC_SUPABASE_URL!;
const supabaseKey =
  process.env.SUPABASE_SERVICE_ROLE_KEY ||
  process.env.EXPO_PUBLIC_SUPABASE_ANON_KEY!;

const supabase = createClient(supabaseUrl, supabaseKey);

const UNSPLASH_IMAGES = [
  "https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?w=600",
  "https://images.unsplash.com/photo-1495474472287-4d71bcdd2085?w=600",
  "https://images.unsplash.com/photo-1541167760496-1628856ab772?w=600",
  "https://images.unsplash.com/photo-1513558161293-cdaf765ed2fd?w=600",
  "https://images.unsplash.com/photo-1504674900247-0877df9cc836?w=600",
  "https://images.unsplash.com/photo-1555041469-a586c61ea9bc?w=600",
  "https://images.unsplash.com/photo-1518780664697-55e3ad937233?w=600",
  "https://images.unsplash.com/photo-1558618666-fcd25c85cd64?w=600",
  "https://images.unsplash.com/photo-1542038784456-1ea8e935640e?w=600",
  "https://images.unsplash.com/photo-1460925895917-afdab827c52f?w=600",
  "https://images.unsplash.com/photo-1551782450-a2132b4ba21d?w=600",
  "https://images.unsplash.com/photo-1484723091739-30a097e8f929?w=600",
];

const AVATAR_IMAGES = [
  "https://images.unsplash.com/photo-1535713875002-d1d0cf377fde?w=150",
  "https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?w=150",
  "https://images.unsplash.com/photo-1494790108377-be9c29b29330?w=150",
  "https://images.unsplash.com/photo-1527980965255-d3b416303d12?w=150",
  "https://images.unsplash.com/photo-1438761681033-6461ffad8d80?w=150",
  "https://images.unsplash.com/photo-1500648767791-00dcc994a43e?w=150",
  "https://images.unsplash.com/photo-1472099645785-5658abf4ff4e?w=150",
];

const FAKE_USERS = [
  { display_name: "ุฃุญูุฏ ุงููููุงูู", location: "ุฑุงู ุงููู", email: "ahmed@example.com" },
  { display_name: "ูุงุทูุฉ ุฃุจู ุนูุฑ", location: "ุงูุฎููู", email: "fatima@example.com" },
  { display_name: "ูุญูุฏ ุงูุนุฑุงุจู", location: "ูุงุจูุณ", email: "mohammed@example.com" },
  { display_name: "ุณุงุฑุฉ ุฌุฑุงุฏุงุช", location: "ุฌููู", email: "sara@example.com" },
  { display_name: "ุนูุฑ ุงูุดุงูู", location: "ุจุฑุทุนุฉ", email: "omar@example.com" },
  { display_name: "ูููู ุญูุฏุงู", location: "ุทูููุฑู", email: "layla@example.com" },
  { display_name: "ุฎุงูุฏ ุนูุถ", location: "ุงููุฏุณ", email: "khalid@example.com" },
];

const POSTS_DATA = [
  {
    title: "ูููุฉ ุนุฑุจูุฉ ุฃุตููุฉ - ููุจูุน",
    subtitle: "ุจูุน",
    description: "ุฃุจูุน ุขูุฉ ูููุฉ ุนุฑุจูุฉ ุฃุตููุฉ ูุน ุทูู ููุงุฌูู ูู ุงููุฎุงุฑ. ุงูุญุงูุฉ ููุชุงุฒุฉุ ุงุณุชุฎุฏุงู ุจุณูุท ุฌุฏุงู. ููุงุณุจุฉ ูููุฏุงูุง ูููุงุณุชุฎุฏุงู ุงููููู.",
    tags: ["ูููุฉ", "ุชุฑุงุซ", "ูุทุจุฎ"],
    price: "ูฅู ุดููู",
  },
  {
    title: "ุฃุจุญุซ ุนู ูุฏุฑุจ ููุงูุฉ ุจุฏููุฉ",
    subtitle: "ุจุญุซ",
    description: "ุฃุจุญุซ ุนู ูุฏุฑุจ ููุงูุฉ ุจุฏููุฉ ูุญุชุฑู ูู ููุทูุฉ ุฑุงู ุงููู. ููุถู ุฃู ูููู ูุฏูู ุฎุจุฑุฉ ูุน ุงููุจุชุฏุฆูู. ูุฑุฌู ุงูุชูุงุตู ูููุงูุดุฉ ุงูุชูุงุตูู.",
    tags: ["ุฑูุงุถุฉ", "ููุงูุฉ", "ุชุฏุฑูุจ"],
    price: null,
  },
  {
    title: "ุบุฑูุฉ ููุฅูุฌุงุฑ ูู ูุงุจูุณ",
    subtitle: "ุฅูุฌุงุฑ",
    description: "ุบุฑูุฉ ููุฑูุดุฉ ููุฅูุฌุงุฑ ูู ููุทูุฉ ูุงุฏุฆุฉ ูู ูุงุจูุณ. ูุฑูุจุฉ ูู ุงูููุงุตูุงุช ุงูุนุงูุฉ ูุงูุฎุฏูุงุช. ุงูุฅูุฌุงุฑ ุดุงูู ุงูููุฑุจุงุก ูุงููุงุก.",
    tags: ["ุฅูุฌุงุฑ", "ุณูู", "ูุงุจูุณ"],
    price: "ูจูู ุดููู/ุดูุฑ",
  },
  {
    title: "ูุนุงููุฉ: ุณูุฑุฉ ููุณูููุฉ ูู ุงูุฎููู",
    subtitle: "ูุนุงููุฉ",
    description: "ุชุดุฑู ุนุงุฆูุฉ ุงูุดุงูู ุจุฏุนูุชูู ูุญุถูุฑ ุณูุฑุฉ ููุณูููุฉ ุชุฑุงุซูุฉ. ุณุชููุงู ุงููุนุงููุฉ ููู ุงูุฌูุนุฉ ุงููุงุฏู. ุงูุฏุนูุฉ ุนุงูุฉ ููุฌููุน.",
    tags: ["ูุนุงููุฉ", "ููุณููู", "ุชุฑุงุซ"],
    price: null,
  },
  {
    title: "ุณูุงุฑุฉ ุชูููุชุง ููุฑููุง ูขููกูจ",
    subtitle: "ุจูุน",
    description: "ุฃุจูุน ุณูุงุฑุฉ ุชูููุชุง ููุฑููุง ููุฏูู ูขููกูจุ ููู ุฃุจูุถุ ูกูกู ุฃูู ูููููุชุฑ. ุจุญุงูุฉ ููุชุงุฒุฉุ ุจุฏูู ุญูุงุฏุซ. ุงููุญุต ูุชุงุญ.",
    tags: ["ุณูุงุฑุฉ", "ุจูุน", "ุชูููุชุง"],
    price: "ูฃูฅููู ุดููู",
  },
  {
    title: "ุฏุฑูุณ ุฎุตูุตูุฉ ูู ุงูุฑูุงุถูุงุช",
    subtitle: "ุฎุฏูุฉ",
    description: "ูุนูู ูุชุฎุตุต ููุฏู ุฏุฑูุณุงู ุฎุตูุตูุฉ ูู ุงูุฑูุงุถูุงุช ูุฌููุน ุงููุฑุงุญู ุงูุฏุฑุงุณูุฉ. ุฎุจุฑุฉ ูกู ุณููุงุช. ูุชุงุฆุฌ ูุถูููุฉ.",
    tags: ["ุชุนููู", "ุฑูุงุถูุงุช", "ุฎุตูุตู"],
    price: "ูฅู ุดููู/ุณุงุนุฉ",
  },
  {
    title: "ุฃุฑููุฉ ูุณุชุนููุฉ - ุญุงูุฉ ุฌูุฏุฉ",
    subtitle: "ุจูุน",
    description: "ุฃุจูุน ุฃุฑููุฉ ุซูุงุซูุฉ ูุณุชุนููุฉ ุจุญุงูุฉ ุฌูุฏุฉ. ุงูููู ุจูุฌุ ููุงุณุจุฉ ูุบุฑูุฉ ุงูุฌููุณ. ุงูุชุณููู ูุชุงุญ ุฏุงุฎู ุงููุฏููุฉ.",
    tags: ["ุฃุซุงุซ", "ุจูุน", "ููุฒู"],
    price: "ูคูู ุดููู",
  },
  {
    title: "ุทุจุงุฎุฉ ุชูุฏูู ููููุงุช ูุญููุงุช",
    subtitle: "ุฎุฏูุฉ",
    description: "ุทุจุงุฎุฉ ูุญุชุฑูุฉ ูุชุฎุตุตุฉ ูู ุชูุฏูู ููููุงุช ูููุงุณุจุงุช. ุฃููุงุช ุดุนุจูุฉ ูุนุตุฑูุฉ. ุงูุณุนุฑ ูุญุฏุฏ ุญุณุจ ุนุฏุฏ ุงูุฃุดุฎุงุต ูุงูุฃุตูุงู.",
    tags: ["ุทุนุงู", "ุฎุฏูุฉ", "ููุงุณุจุงุช"],
    price: null,
  },
  {
    title: "ูุงุชู ุขูููู ูกูฃ ููุจูุน",
    subtitle: "ุจูุน",
    description: "ุฃุจูุน ุขูููู ูกูฃ ููู ุฃุณูุฏุ ูกูขูจ ุฌูุฌุง. ุงูุญุงูุฉ ููุชุงุฒุฉ ูุน ุงูุตูุฏูู ุงูุฃุตูู ูููุญูุงุชู. ูุณุชุฎุฏู ุณูุฉ ูุงุญุฏุฉ ููุท.",
    tags: ["ูุงุชู", "ุขูููู", "ุชูููุฉ"],
    price: "ูขูขูู ุดููู",
  },
  {
    title: "ุญููุฉ ุชุญููุธ ูุฑุขู ูุฑูู - ููุฃุทูุงู",
    subtitle: "ุฏุนูุฉ",
    description: "ูุนูู ุนู ูุชุญ ุจุงุจ ุงูุชุณุฌูู ูู ุญููุฉ ุชุญููุธ ุงููุฑุขู ุงููุฑูู ููุฃุทูุงู ูู ุณู ูฅ-ูกูข ุณูุฉ. ุงููุญุงุถุฑุงุช ุซูุงุซ ูุฑุงุช ุฃุณุจูุนูุงู.",
    tags: ["ุฏูู", "ุชุญููุธ", "ุฃุทูุงู"],
    price: null,
  },
  {
    title: "ุญุฏููุฉ ููุฒููุฉ ููุชุฃุฌูุฑ",
    subtitle: "ุฅูุฌุงุฑ",
    description: "ุญุฏููุฉ ููุฒููุฉ ุฌูููุฉ ููุฌูุฒุฉ ุจุงููุงูู ููุชุฃุฌูุฑ ููููุงุณุจุงุช ูุงูุฃูุฑุงุญ ุงูุตุบูุฑุฉ. ุชุชุณุน ูู ูกูู ุดุฎุต. ูุฌูุฒุฉ ุจุงูููุงุนุฏ ูุงูุทุงููุงุช.",
    tags: ["ุญุฏููุฉ", "ุชุฃุฌูุฑ", "ููุงุณุจุงุช"],
    price: "ูจูู ุดููู/ุงูููู",
  },
  {
    title: "ูุฌููุนุฉ ูุชุจ ุนุฑุจูุฉ - ููุจูุน ุฃู ุงูุชุจุงุฏู",
    subtitle: "ุจูุน ุฃู ุชุจุงุฏู",
    description: "ูุฏู ูุฌููุนุฉ ูุจูุฑุฉ ูู ุงููุชุจ ุงูุนุฑุจูุฉ ูู ูุฌุงูุงุช ูุชููุนุฉ: ุฃุฏุจุ ุชุงุฑูุฎุ ุฑูุงูุงุช. ุฃุจูุน ุจุงููุทุนุฉ ุฃู ุฃุชุจุงุฏู ูุน ูุชุจ ุฃุฎุฑู.",
    tags: ["ูุชุจ", "ุฃุฏุจ", "ุซูุงูุฉ"],
    price: "ูขู-ูฅู ุดููู",
  },
  {
    title: "ูุฑุดุฉ ุฎูุงุทุฉ ูุชูุตูู",
    subtitle: "ุฎุฏูุฉ",
    description: "ูุฑุดุฉ ุฎูุงุทุฉ ูุชูุตูู ูุชุฎุตุตุฉ ูู ุงูููุงุจุณ ุงูุชูููุฏูุฉ ูุงูุนุตุฑูุฉ. ููุจู ุงูุชุตููุญ ูุงูุชุนุฏูู ูุงูุชูุตูู ุญุณุจ ุงูุทูุจ.",
    tags: ["ุฎูุงุทุฉ", "ุชูุตูู", "ุฎุฏูุฉ"],
    price: null,
  },
  {
    title: "ุญุตุงู ุนุฑุจู ุฃุตูู ููุจูุน",
    subtitle: "ุจูุน",
    description: "ุฃุจูุน ุญุตุงู ุนุฑุจู ุฃุตููุ ุนูุฑู ูค ุณููุงุชุ ูุฑูุถ ูุชุฏุฑูุจ ุนุงูู. ููุงุณุจ ููุฑููุจ ูุงูุฑูุงุถุฉ. ุงููุดุงูุฏุฉ ูุชุงุญุฉ.",
    tags: ["ุฎููู", "ุญููุงูุงุช", "ุจูุน"],
    price: "ูจููู ุดููู",
  },
  {
    title: "ูุญู ุจูุงูุฉ ููุฅูุฌุงุฑ",
    subtitle: "ุฅูุฌุงุฑ",
    description: "ูุญู ุจูุงูุฉ ูู ูููุน ุชุฌุงุฑู ููุชุงุฒ ููุฅูุฌุงุฑ. ุงููุณุงุญุฉ ูฆู ูุชุฑ ูุฑุจุนุ ูุฌูุฒ ุจุงูุฑููู ูุงูุซูุงุฌุงุช. ูููุน ุญููู ุนูู ุงูุดุงุฑุน ุงูุฑุฆูุณู.",
    tags: ["ุชุฌุงุฑู", "ุฅูุฌุงุฑ", "ูุญู"],
    price: "ูฃููู ุดููู/ุดูุฑ",
  },
  {
    title: "ุฏุนูุฉ ูุญุถูุฑ ูุนุฑุถ ุงููู ุงููุญูู",
    subtitle: "ุฏุนูุฉ",
    description: "ูุณุนุฏูุง ุฏุนูุชูู ูุญุถูุฑ ูุนุฑุถ ุงููู ุงููุญูู ุงูุฐู ูุถู ุฃุนูุงู ููุงููู ูุญูููู ููููุจูู. ุงููุนุฑุถ ููุชูุญ ุทูุงู ุงูุฃุณุจูุน ุงููุงุฏู.",
    tags: ["ูู", "ูุนุฑุถ", "ุซูุงูุฉ"],
    price: null,
  },
  {
    title: "ุฎุฏูุฉ ุชูุธูู ุงูููุงุฒู",
    subtitle: "ุฎุฏูุฉ",
    description: "ูุฑูู ูุชุฎุตุต ูุชูุธูู ุงูููุงุฒู ูุงูุดูู ุจุดูู ุงุญุชุฑุงูู. ูุณุชุฎุฏู ููุงุฏ ุชูุธูู ุนุงููุฉ ุงูุฌูุฏุฉ. ููุจู ุงูุญุฌุฒ ุงูุฃุณุจูุนู ูุงูุดูุฑู.",
    tags: ["ุชูุธูู", "ุฎุฏูุฉ", "ููุฒู"],
    price: "ูขูฅู ุดููู/ูุฑุฉ",
  },
  {
    title: "ูุงุจุชูุจ ุฏูู ููุจูุน",
    subtitle: "ุจูุน",
    description: "ูุงุจุชูุจ Dell ุงูุฌูู ุงูุนุงุดุฑุ ุฑุงู ูกูฆ ุฌูุฌุงุ ุฐุงูุฑุฉ ูฅูกูข SSD. ููุงุณุจ ููุทูุงุจ ูุงูุนูู. ูุง ููุฌุฏ ูุดุงูู ุชูููุฉ.",
    tags: ["ูุงุจุชูุจ", "ุชูููุฉ", "ุจูุน"],
    price: "ูกูจูู ุดููู",
  },
  {
    title: "ุดุฑูู ููุนูู ูู ูุดุฑูุน ูุทุนู",
    subtitle: "ุจุญุซ",
    description: "ุฃุจุญุซ ุนู ุดุฑูู ุฌุงุฏ ููุฏุฎูู ูุนู ูู ูุดุฑูุน ูุทุนู ูููุฌุจุงุช ุงูุณุฑูุนุฉ. ูุฏู ุงููููุน ูุงููุนุฏุงุช. ุฃุจุญุซ ุนู ุดุฑูู ุจุฎุจุฑุฉ ูู ุงููุฌุงู.",
    tags: ["ุดุฑุงูุฉ", "ูุทุนู", "ุงุณุชุซูุงุฑ"],
    price: null,
  },
  {
    title: "ุชุตููุฑ ููุชูุบุฑุงูู ููููุงุณุจุงุช",
    subtitle: "ุฎุฏูุฉ",
    description: "ูุตูุฑ ููุชูุบุฑุงูู ูุญุชุฑู ูุชุงุญ ูุชุตููุฑ ุงูุฃูุฑุงุญ ูุงูููุงุณุจุงุช. ูุนุฏุงุช ุงุญุชุฑุงููุฉ ููุชุงุฆุฌ ุนุงููุฉ ุงูุฌูุฏุฉ. ุงูุชุญุฑูุฑ ูุงูุชูุตูู ุฎูุงู ูงูข ุณุงุนุฉ.",
    tags: ["ุชุตููุฑ", "ููุงุณุจุงุช", "ุฎุฏูุฉ"],
    price: "ูจูู ุดููู/ุงูููู",
  },
  {
    title: "ุฃุฑุถ ุฒุฑุงุนูุฉ ููุจูุน - ุจุฑุทุนุฉ",
    subtitle: "ุจูุน",
    description: "ุฃุฑุถ ุฒุฑุงุนูุฉ ูุณุงุญุชูุง ูข ุฏููู ูู ููุทูุฉ ุจุฑุทุนุฉ. ูุฒุฑูุนุฉ ุจุฃุดุฌุงุฑ ุงูุฒูุชูู. ูุณุฌูุฉ ููุซุงุฆููุง ูุงููุฉ. ููุงุณุจุฉ ููุงุณุชุซูุงุฑ.",
    tags: ["ุฃุฑุถ", "ุฒุฑุงุนุฉ", "ุนูุงุฑุงุช"],
    price: "ูคูููู ุดููู",
  },
  {
    title: "ุฅุนูุงู: ุชูุธูู ุจุงุฆุนูู",
    subtitle: "ุชูุธูู",
    description: "ูุทููุจ ุจุงุฆุนูู ููุญูุงุช ุชุฌุงุฑูุฉ ูู ูุฏููุฉ ูุงุจูุณ. ูุดุชุฑุท ุญุณู ุงููุธูุฑ ูุงูุชุนุงูู. ุงูุฑุงุชุจ ุญุณุจ ุงูุงุชูุงู ูุน ููุงูุขุช.",
    tags: ["ูุธููุฉ", "ุจูุน", "ูุงุจูุณ"],
    price: null,
  },
  {
    title: "ูุณุชูุฒูุงุช ุฑุถุน - ุจุญุงูุฉ ููุชุงุฒุฉ",
    subtitle: "ุจูุน",
    description: "ุฃุจูุน ูุฌููุนุฉ ูุชูุงููุฉ ูู ูุณุชูุฒูุงุช ุงูุฑุถุน: ุณุฑูุฑุ ูุฑุณู ุณูุงุฑุฉุ ุนุฑุจุฉ. ูุธููุฉ ุจุญุงูุฉ ููุชุงุฒุฉ. ููุงุณุจุฉ ููููููุฏูู ุงูุฌุฏุฏ.",
    tags: ["ุฃุทูุงู", "ุฑุถุน", "ูุณุชูุฒูุงุช"],
    price: "ูฆูู ุดููู ุงููุฌููุนุฉ",
  },
  {
    title: "ูุฏุฑุณ ููุณููู - ุนูุฏ ูุจูุงูู",
    subtitle: "ุฎุฏูุฉ",
    description: "ูุฏุฑุณ ููุณููู ูุนุชูุฏ ููุฏู ุฏุฑูุณุงู ูู ุงูุนุฒู ุนูู ุงูุนูุฏ ูุงูุจูุงูู. ูููุจุชุฏุฆูู ูุงููุชูุฏููู. ุงูุฏุฑูุณ ูุชุงุญุฉ ูู ุจูุชู ุฃู ุจูุชู.",
    tags: ["ููุณููู", "ุชุนููู", "ูููู"],
    price: "ูฆู ุดููู/ุณุงุนุฉ",
  },
];

async function seed() {
  console.log("๐ฑ Starting seed...");

  // Create users in auth + profile table
  const userIds: string[] = [];
  for (let i = 0; i < FAKE_USERS.length; i++) {
    const u = FAKE_USERS[i];
    const password = "Password123!";

    const { data: authData, error: authError } = await supabase.auth.admin.createUser({
      email: u.email,
      password,
      email_confirm: true,
    });

    if (authError) {
      console.warn(`โ๏ธ Could not create auth user ${u.email}:`, authError.message);
      continue;
    }

    const userId = authData.user.id;
    userIds.push(userId);

    const { error: profileError } = await supabase.from("users").insert({
      id: userId,
      email: u.email,
      display_name: u.display_name,
      location: u.location,
      avatar_url: AVATAR_IMAGES[i % AVATAR_IMAGES.length],
    });

    if (profileError) {
      console.warn(`โ๏ธ Could not insert profile for ${u.email}:`, profileError.message);
    } else {
      console.log(`โ Created user: ${u.display_name}`);
    }
  }

  if (userIds.length === 0) {
    console.error("โ No users created. Aborting.");
    return;
  }

  // Create posts
  for (let i = 0; i < POSTS_DATA.length; i++) {
    const p = POSTS_DATA[i];
    const userId = userIds[i % userIds.length];
    const imgCount = Math.floor(Math.random() * 2) + 1;
    const images = Array.from({ length: imgCount }, (_, j) =>
      UNSPLASH_IMAGES[(i + j) % UNSPLASH_IMAGES.length]
    );

    const { error } = await supabase.from("posts").insert({
      user_id: userId,
      title: p.title,
      subtitle: p.subtitle,
      description: p.description,
      images,
      tags: p.tags,
      price: p.price,
    });

    if (error) {
      console.warn(`โ๏ธ Could not insert post "${p.title}":`, error.message);
    } else {
      console.log(`โ Created post: ${p.title}`);
    }
  }

  console.log("\nโ Seed complete!");
  console.log(`Created ${userIds.length} users and up to ${POSTS_DATA.length} posts.`);
  console.log("\nTest login credentials:");
  FAKE_USERS.forEach((u) => console.log(`  ${u.email} / Password123!`));
}

seed().catch(console.error);
